services:

  backend:
    build: ./backend
    command: daphne -b 0.0.0.0 -p ${PORT:-8000} config.asgi:application
    volumes:
      - ./backend:/app
    ports:
      - "8000:8000"
    environment:
      # Prefer URL-style env vars in prod (Railway)
      DATABASE_URL: ${DATABASE_URL}
      REDIS_URL: ${REDIS_URL}
      # Optional fallback vars for local/dev if not using URLs
      DB_NAME: ${DB_NAME}
      DB_USER: ${DB_USER}
      DB_PASSWORD: ${DB_PASSWORD}
      DB_HOST: ${DB_HOST}
      DB_PORT: ${DB_PORT:-5432}
      REDIS_HOST: ${REDIS_HOST:-redis}
      REDIS_PORT: ${REDIS_PORT:-6379}
      SECRET_KEY: ${SECRET_KEY}
      DEBUG: ${DEBUG}

#volumes:
 # pgdata:
